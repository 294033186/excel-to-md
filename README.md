# Excel转Markdown插件使用指南 (v0.1.1)

## 简介

Excel转Markdown插件是一个为Dify平台开发的工具型插件，可以将Excel文件(.xlsx, .xls)转换为Markdown表格格式。该插件支持多工作表、合并单元格和基本格式化，使您能够轻松地将Excel数据用于Markdown支持的环境。

## 功能特点

- 将Excel文件转换为格式化的Markdown表格
- 支持多工作表处理
- 自动检测并处理数据类型，提供合适的列对齐方式
- 支持自定义表头和对齐方式
- 处理特殊字符和格式
- 支持大型Excel文件
- 完全兼容Python 3.12
- 提供调试环境变量支持
- 符合Dify工具型插件规范，包含tools目录

## 安装方法

### 方法1：通过Dify插件市场安装

1. 登录您的Dify账户
2. 导航至"插件市场"
3. 搜索"excel-to-md"
4. 点击"安装"按钮

### 方法2：手动安装

1. 下载插件压缩包
2. 解压到本地目录
3. 在Dify平台中，导航至"插件管理" > "上传插件"
4. 选择解压后的插件目录
5. 点击"上传"完成安装

## 使用方法

### 基本使用

1. 在Dify应用中，添加"excel-to-md"工具
2. 上传Excel文件
3. 插件将自动处理并返回Markdown格式的表格文本

### 配置选项

插件提供以下配置选项：

| 配置项 | 说明 | 默认值 |
| :------ | :------ | :------ |
| 使用第一行作为表头 | 是否将Excel的第一行作为Markdown表格的表头 | 是 |
| 工作表名称 | 指定要转换的工作表名称，留空则转换所有工作表 | 空（转换所有） |
| 列对齐方式 | 设置Markdown表格的列对齐方式 | 自动（基于内容） |

### 对齐方式选项

- **自动**：根据列内容类型自动选择对齐方式（数字右对齐，文本左对齐，日期/状态居中）
- **左对齐**：所有列左对齐
- **居中**：所有列居中对齐
- **右对齐**：所有列右对齐

## 在工作流中使用

在Dify工作流应用中，插件会返回以下变量：

- `markdown_text`：转换后的Markdown表格文本
- `sheet_names`：已转换的工作表名称列表

您可以在后续节点中引用这些变量，例如：

```
{{excel_to_markdown.markdown_text}}
```

## 示例

### 输入：简单Excel表格

| Name | Age | City | Score |
| ---- | --- | ---- | ----- |
| Alice | 25 | New York | 95.5 |
| Bob | 30 | London | 88.3 |
| Charlie | 35 | Paris | 76.9 |
| David | 40 | Tokyo | 92.1 |

### 输出：Markdown表格

```markdown
## Sheet1

| Name    | Age | City     | Score |
| :------ | --: | :------- | ----: |
| Alice   | 25  | New York | 95.5  |
| Bob     | 30  | London   | 88.3  |
| Charlie | 35  | Paris    | 76.9  |
| David   | 40  | Tokyo    | 92.1  |
```

## 常见问题

### Q: 插件支持哪些Excel文件格式？
A: 插件支持.xlsx和.xls格式的Excel文件。

### Q: 如何处理合并单元格？
A: 插件会尝试保留合并单元格的内容，但由于Markdown表格的限制，合并单元格的视觉效果无法完全保留。

### Q: 插件是否有文件大小限制？
A: 默认情况下，插件限制文件大小为10MB，可通过环境变量`MAX_FILE_SIZE`调整。

### Q: 如何处理包含特殊字符的Excel文件？
A: 插件会自动处理和转义Markdown中的特殊字符，确保输出的Markdown表格格式正确。

### Q: 如果Excel中有公式，插件会如何处理？
A: 插件会处理公式的计算结果，而不是公式本身。

### Q: 插件是否支持Python 3.12？
A: 是的，插件已完全兼容Python 3.12环境。

### Q: 为什么插件使用tools目录结构？
A: 这是Dify工具型插件的标准结构，有助于更好地组织代码和维护插件。

## 技术支持

如有任何问题或需要技术支持，请联系插件开发者或在Dify社区论坛中提问。

## 版本历史

- v0.1.1 - 更新项目名称为excel-to-md，采用工具型插件结构，更新Python环境至3.12，添加调试支持
- v0.0.1 - 初始版本
